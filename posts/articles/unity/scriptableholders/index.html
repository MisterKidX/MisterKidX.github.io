<!doctype html><html><head><title>Scriptable Holders</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600"><link rel=stylesheet href=/fontawesome/css/all.min.css><link rel=stylesheet href=/css/colortheme/colortheme.css><link rel=icon type=image/png href=/images/logo/logo_hu6140f218ff0d771f0d143c83c939cc9f_11045_42x0_resize_box_2.png><meta property="og:title" content="Scriptable Holders"><meta property="og:description" content="Scriptable Holders are Decorators for Serializable classes. They provide a simple way to hook plain code into the unity engine."><meta property="og:type" content="article"><meta property="og:url" content="https://www.dorbendor.com/posts/articles/unity/scriptableholders/"><meta property="article:published_time" content="2024-09-18T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-18T00:00:00+00:00"><meta name=description content="Scriptable Holders are Decorators for Serializable classes. They provide a simple way to hook plain code into the unity engine."><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css><script data-goatcounter=https://misterkidx.goatcounter.com/count async src=//gc.zgo.at/count.js></script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/logo/logo_hu6140f218ff0d771f0d143c83c939cc9f_11045_42x0_resize_box_2.png alt=Logo>
Dor Ben Dor</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><div id=theme-initialization style=display:none default-theme=system></div><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20></a><div class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# onclick=enableLightTheme()><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20></a>
<a class="dropdown-item nav-link" href=# onclick=enableDarkTheme()><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20></a>
<a class="dropdown-item nav-link" href=# onclick=useSystemTheme()><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20></a></div></li></ul></div></div><img src=/images/logo/logo_hu6140f218ff0d771f0d143c83c939cc9f_11045_42x0_resize_box_2.png class=d-none id=main-logo alt=Logo>
<img src=/images/logo/logo_hu6140f218ff0d771f0d143c83c939cc9f_11045_42x0_resize_box_2.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/articles/>Articles</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/articles/unity/>Unity</a><ul class=active><li><a class=active href=/posts/articles/unity/scriptableholders/ title="Scriptable Holders">Scriptable Holders</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/>Projects</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/published/>Published</a><ul><li><a href=/posts/projects/published/warriors-rise-to-glory/ title="Warriors: Rise to glory">Warriors: Rise to glory</a></li><li><a href=/posts/projects/published/midbaryom/ title=Midbaryom>Midbaryom</a></li><li><a href=/posts/projects/published/summoners-royale/ title="Summoners Royale">Summoners Royale</a></li><li><a href=/posts/projects/published/my-first-animal/ title="My First Animal">My First Animal</a></li><li><a href=/posts/projects/published/brainiac/ title=Brainiac>Brainiac</a></li><li><a href=/posts/projects/published/party-cat/ title="Party Cat">Party Cat</a></li><li><a href=/posts/projects/published/yeti-getaway/ title="Yeti Getaway">Yeti Getaway</a></li><li><a href=/posts/projects/published/bow-and-arrow/ title="Bow & Arrow">Bow & Arrow</a></li><li><a href=/posts/projects/published/colormaze/ title="Color Maze">Color Maze</a></li><li><a href=/posts/projects/published/neuroderm/ title=Neuroderm>Neuroderm</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/development/>In Development</a><ul><li><a href=/posts/projects/development/phantom-beasts/ title="Phantom Beasts">Phantom Beasts</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/misc/>Misc.</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/misc/exercises/>Exercises</a><ul><li><a href=/posts/projects/misc/exercises/vox/ title=VoX>VoX</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/misc/hackathons/>Hackathons</a><ul><li><a href=/posts/projects/misc/hackathons/treasure-hunt/ title="Treasure Hunt">Treasure Hunt</a></li></ul></li></ul></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/articles/unity/scriptableholders/Banner_ScriptableHolders.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/dor_pixelart_hu2ee8936c0dc6917a49809c152d22d3be_2873_120x120_fit_box_2.png alt="Author Image"><h5 class=author-name>Dor Ben Dor</h5><p>:date_full</p></div><div class=title><h1>Scriptable Holders</h1></div><div class=taxonomy-terms><ul><li class=rounded><a href=/tags/unity class="btn, btn-sm">unity</a></li><li class=rounded><a href=/tags/scriptable-objects class="btn, btn-sm">scriptable objects</a></li><li class=rounded><a href=/tags/architecture class="btn, btn-sm">architecture</a></li><li class=rounded><a href=/tags/coding class="btn, btn-sm">coding</a></li><li class=rounded><a href=/tags/c class="btn, btn-sm">C#</a></li><li class=rounded><a href=/tags/editor class="btn, btn-sm">editor</a></li></ul></div><div class=post-content id=post-content><h3 id=preface>Preface</h3><p><a href=https://docs.unity3d.com/Manual/class-ScriptableObject.html>Scriptable Objects</a> (SOs) are awesome. It&rsquo;s been said before, it will be said in the future and currently, many Unity devs use them to architect their code and write great games. But (you knew this was coming), they are still a tight coupling to the unity engine - Scriptable Objects only make sense inside the unity framework. I noticed most Unity devs don&rsquo;t give a f*** about this, but I do give plenty. To avoid my rant about how writing C# in Unity is like driving a Bugatti at 10 MPH on the freeway I&rsquo;ll just say that I like to write <a href=https://en.wikipedia.org/wiki/Plain_old_CLR_object>Plain Old C# Objects</a> (<a href="https://www.youtube.com/watch?v=yg8116aeD7E&ab_channel=DisneyMusicVEVO">POCOS</a>) and that writing code that is not tightly coupled to a specific framework is generally a good thing.</p><p>Stemming from this assumption, and admitting that not all code files are yours to change and just inherit from ScriptableObject, I created Scriptable Holders - simple SOs that decorate serializable classes and allow me to hook my plain classes back into Unity.</p><p>Scriptable Holders are a framework-specific solution for unity. In essence, they are <a href=https://refactoring.guru/design-patterns/decorator>Decorators</a> for POCOS - they provide an easy way to hook POCOS into the unity framework. In a semantic way, scriptable holders are like the old <a href="https://learn.microsoft.com/en-us/dotnet/api/system.nullable-1?view=net-8.0">Nullable&lt;T></a> implementation in C#, or <a href="https://learn.microsoft.com/en-us/dotnet/api/system.lazy-1?view=net-8.0">Lazy&lt;T></a>. They just wrap around a value to give it special properties, in this case, hooking it to unity.</p><p>I originally needed them a couple of years back while wanting to debug and create client-side mock environments for my client&rsquo;s server. I wrapped serializable API responses, thus allowing both me and the QA to quickly change and view the response in editor time to suit our needs.</p><p float=left align=center><img src=MockAPI.svg width=30%>
<img src=MockAPIHolder.svg width=30%>
<img src=scriptableHolderAPIResponse_noEditor.png width=30%></p><h3 id=abstract>Abstract</h3><p><strong>Problem Statement</strong> - I want to hook my C# code to unity without inheriting from <code>ScriptableObject</code>, either because I can&rsquo;t or because I don&rsquo;t want to tightly couple my code.</p><p><strong>Solution</strong> - Scriptable Holders: SOs designed to hold an external serialized class value.</p><h4 id=code-solution>Code Solution</h4><p>Let&rsquo;s create an abstract class that will hold the structure of what Scriptable Holders (SH) do. Derived classes would just need to inherit from this base class and add an attribute for creating the SO.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ScriptableHolder</span>&lt;T&gt; : ScriptableObject
{
    <span style=color:#66d9ef>public</span> T Value;
}
</code></pre></div><p><p>this sets us on a good path<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. Let&rsquo;s test an implementation and see it in the Unity editor.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#a6e22e>[UnityEngine.CreateAssetMenu(menuName = &#34;Create Player Mock API Holder&#34;)]</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PlayerMockAPIResponseHolder</span> : ScriptableHolder&lt;PlayerMockAPIResponse&gt; { }
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#a6e22e>[Serializable]</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PlayerMockAPIResponse</span>
{
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name;
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Money;
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Damage;
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>float</span> DamageReduction;
}
</code></pre></div><p><p align=center><img title="Player Mock Response Holder" alt="an image of an SO holding reference to the mock API class" src=scriptableHolderAPIResponse_noEditor.png></p><p>Now we have a base class for holding external values. All this SO does is wrap around the T value, in this case, the <code>PlayerMockAPIResponse</code>. Imagine you get an API response from your server and want to debug its values easily: create local mock responses, mutate existing responses, visually see the response, and allow less technical staff to view the data.</p><p>You can also easily use the ScriptableHolder&lt;T> class as a member of any other class, and monobehaviours will serialize it properly.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MBTestSH</span> : MonoBehaviour
{
    <span style=color:#66d9ef>public</span> ScriptableHolder&lt;PlayerMockAPIResponse&gt; genric;
    <span style=color:#66d9ef>public</span> PlayerMockAPIResponseHolder dervied;
}
</code></pre></div><p align=center><img src=MBTestSH.png></p><p>This is enough to start using this framework solution, but&mldr; I&rsquo;ve used holders for quite some time and seeing that annoying foldout arrow and having all the data indented annoyed the living hell out of me. It&rsquo;s time for some editor scripting y&rsquo;all.</p><h3 id=editor>Editor</h3><p>In our editor scripting journey, we are going to do the following:</p><ul><li>we are going to get rid of that annoying foldout arrow</li><li>we are going to apply the editor script to all inheriting members of ScriptableHolder base class</li><li>we are going to deny wrapping around MonoBehaviours</li><li>we are going to deny wrapping around none supported types</li><li>we are going to set a customized icon for all holders</li><li>we are going to set a customized icon for bad holders</li></ul><h4 id=the-annoying-foldout-arrow>The Annoying Foldout Arrow</h4><p>You would expect Unity to have a simple API method for this, or even something hidden you could extract with reflection. But no. We have to do it manually.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#66d9ef>using</span> System.Reflection;
<span style=color:#66d9ef>using</span> UnityEngine;
<span style=color:#66d9ef>using</span> UnityEditor;
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[CustomEditor(typeof(ScriptableHolder&lt;&gt;), true)]</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ScriptableHolderEditor</span> : Editor
{
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>void</span> OnInspectorGUI()
    {
        serializedObject.Update();

        SerializedProperty valueProp = serializedObject.FindProperty(<span style=color:#e6db74>&#34;Value&#34;</span>);

        <span style=color:#66d9ef>if</span> (valueProp != <span style=color:#66d9ef>null</span> &amp;&amp; valueProp.propertyType == SerializedPropertyType.Generic)
        {
            <span style=color:#66d9ef>var</span> SOType = target.GetType();
            <span style=color:#66d9ef>var</span> type = SOType.GetField(<span style=color:#e6db74>&#34;Value&#34;</span>).FieldType;
            <span style=color:#66d9ef>var</span> fields = type.GetFields(BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);

            <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> field <span style=color:#66d9ef>in</span> fields)
            {
                SerializedProperty fieldProp = valueProp.FindPropertyRelative(field.Name);

                <span style=color:#66d9ef>if</span> (fieldProp != <span style=color:#66d9ef>null</span>)
                    EditorGUILayout.PropertyField(fieldProp, <span style=color:#66d9ef>new</span> GUIContent(ObjectNames.NicifyVariableName(field.Name)));
            }
        }

        serializedObject.ApplyModifiedProperties();
    }
}
</code></pre></div><p><p>All and all this is pretty straightforward. We collect all fields of the serialized class, find their respective Serialized Properties, and serialize them back. Using Serialized Properties assures us we only show the fields that should be serialized, and we hook into Unity&rsquo;s Do\Undo system and save system.</p><p><a href=https://docs.unity3d.com/ScriptReference/ObjectNames.html><code>ObjectNames</code></a> is a helper class for displaying field names nicely (e.g. field name could be _myVar and display is My Var).</p><p>Pay attention to <a href=https://docs.unity3d.com/ScriptReference/CustomEditor-ctor.html><code>[CustomEditor(typeof(ScriptableHolder&lt;>), true)]</code></a>, we added another boolean argument with a <code>true</code> value. This will allow our editor script to be drawn for all inheriting classes of ScriptableHolder&lt;>. Without this, you would see no changes to the editor representation of holder objects.</p><p>Open Unity, create a new instance of <code>PlayerMockAPIResponseHolder</code> and watch that nicely none-tabbed data. That menacing arrow is gone.</p><p align=center><img title="Player Mock Response Holder" alt="an image of an SO holding reference to the mock API class with the editor script" src=scriptableHolderAPIResponse.png><p align=center style=color:gray;font-size:12px><i>"Oh, thank god" - OCD game dev</i></p></p><h4 id=denying-bad-generic-arguments>Denying Bad Generic Arguments</h4><p>Our Scriptable Holder is intended to hold a reference to Serializable POCOS, nothing else. Although theoretically, it can hold any value, I didn&rsquo;t find any reason to support this via editor script (<a href=https://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it>YAGNI</a>). This means we need to notify anyone using a Scriptable Holder that she is doing something wrong. Adding the following <code>else</code> clauses closes the deal.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (valueProp != <span style=color:#66d9ef>null</span> &amp;&amp; valueProp.propertyType == SerializedPropertyType.ObjectReference)
    EditorGUILayout.HelpBox(<span style=color:#e6db74>&#34;You cannot wrap values that derive from UnityEngine.Object.&#34;</span>, MessageType.Warning);
<span style=color:#66d9ef>else</span>
    EditorGUILayout.HelpBox(<span style=color:#e6db74>&#34;No valid &#39;Value&#39; property found.&#34;</span>, MessageType.Warning);
</code></pre></div><p><p>Now this is how things look like if we try to wrap around a Gameobject.</p><p align=center><img title="Player Mock Response Holder" alt="an image of an SO holding reference to the mock API class with the editor script" src=WrappingGameobject.png></p><h4 id=improving-editor-ux>Improving Editor UX</h4><p>To differentiate our Scriptable Holders from other common-peasent scriptable objects we need a customized icon. While setting icons can be done through the editor, in this case, it&rsquo;ll not work. Since <code>ScriptableHolder</code> is abstract, it never has instances, and derived classes do not &ldquo;inherit&rdquo; icons. We must do this through our editor script, as follows:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#75715e>// this is instead of setting the icon manualy for each new derived ScriptableHolder
</span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> Texture2D RenderStaticPreview(<span style=color:#66d9ef>string</span> assetPath, Object[] subAssets, <span style=color:#66d9ef>int</span> width, <span style=color:#66d9ef>int</span> height)
{
    <span style=color:#66d9ef>var</span> icon = AssetDatabase.LoadAssetAtPath&lt;Texture2D&gt;(<span style=color:#e6db74>&#34;Assets/Gizmos/ScriptableHolder Icon.png&#34;</span>);
    EditorGUIUtility.SetIconForObject(target, icon);

    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>base</span>.RenderStaticPreview(assetPath, subAssets, width, height);
}
</code></pre></div><p><p align=center><img src=inspectorIcon.png></p><p align=center><img src=heirarchyIcon.png></p><p>Of course, we need a texture named so in the Gizmos folder<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, if you are building this on your own instead of forking the repo, you can go ahead and use the icon i&rsquo;ve prepared in the repo.</p><p>There&rsquo;s one final touch before wer&rsquo;e through. I want Scriptable Holders with bad generic argument to show a warning icon. Let&rsquo;s refactor:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#75715e>// this is instead of setting the icon manualy for each new derived ScriptableHolder
</span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> Texture2D RenderStaticPreview(<span style=color:#66d9ef>string</span> assetPath, Object[] subAssets, <span style=color:#66d9ef>int</span> width, <span style=color:#66d9ef>int</span> height)
{
    SerializedProperty valueProp = serializedObject.FindProperty(<span style=color:#e6db74>&#34;Value&#34;</span>);

    <span style=color:#66d9ef>if</span> (valueProp != <span style=color:#66d9ef>null</span> &amp;&amp; valueProp.propertyType == SerializedPropertyType.Generic)
    {
        <span style=color:#66d9ef>var</span> icon = AssetDatabase.LoadAssetAtPath&lt;Texture2D&gt;(<span style=color:#e6db74>&#34;Assets/Gizmos/ScriptableHolder Icon.png&#34;</span>);

        EditorGUIUtility.SetIconForObject(target, icon);
    }
    <span style=color:#66d9ef>else</span>
    {
        EditorGUIUtility.SetIconForObject(target, EditorGUIUtility.IconContent(<span style=color:#e6db74>&#34;console.warnicon@2x&#34;</span>).image <span style=color:#66d9ef>as</span> Texture2D);
    }

    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>base</span>.RenderStaticPreview(assetPath, subAssets, width, height);
}
</code></pre></div><p><p>Nothing fancy here, maybe just a bit cryptic. The <a href=https://docs.unity3d.com/ScriptReference/EditorGUIUtility.IconContent.html><code>EditorGuiUtility.IconContent</code></a> allows us to fetch internal and default unity icons.</p><h3 id=summary>Summary</h3><p>Scriptable Hodlers are great. They allow us to Decorate a serializable class with the capabilites of a Scriptable Object, easily hooking the class to unity and keeping the original code clean and decoupled. They are simple, scarcely used, and they would not change the way you work with Unity - which is exactly why I like them.</p><h5 id=important-links>Important Links</h5><p><a href=https://github.com/MisterKidX/Articles/tree/ScriptableHolders>🔗 My Git Repo for Article</a> - find a complete unity project with all code samples present</p><p><a href=https://github.com/MisterKidX/UnityCodingToolset>🔗 My Unity Coding Toolset Repo</a> - my coding package for unity, which scriptable holders is a part of (doesn&rsquo;t really deserve a standalone package)</p><p><a href=https://github.com/jasursadikov/unity-editor-icons>🔗 Unity Editor Icons</a> - Check out this great repo for all the editor internal icons.</p><h4 id=final-code>Final Code</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#66d9ef>using</span> System;
<span style=color:#66d9ef>using</span> UnityEngine;

<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ScriptableHolder</span>&lt;T&gt; : ScriptableObject
{
    <span style=color:#66d9ef>public</span> T Value;
}
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[Serializable]</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PlayerMockAPIResponse</span>
{
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name;
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Money;
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Damage;
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>float</span> DamageReduction;
}
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#66d9ef>using</span> System.Reflection;
<span style=color:#66d9ef>using</span> UnityEngine;
<span style=color:#66d9ef>using</span> UnityEditor;
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[CustomEditor(typeof(ScriptableHolder&lt;&gt;), true)]</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ScriptableHolderEditor</span> : Editor
{
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>void</span> OnInspectorGUI()
    {
        serializedObject.Update();

        SerializedProperty valueProp = serializedObject.FindProperty(<span style=color:#e6db74>&#34;Value&#34;</span>);

        <span style=color:#66d9ef>if</span> (valueProp != <span style=color:#66d9ef>null</span> &amp;&amp; valueProp.propertyType == SerializedPropertyType.Generic)
        {
            <span style=color:#66d9ef>var</span> SOType = target.GetType();
            <span style=color:#66d9ef>var</span> type = SOType.GetField(<span style=color:#e6db74>&#34;Value&#34;</span>).FieldType;
            <span style=color:#66d9ef>var</span> fields = type.GetFields(BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);

            <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> field <span style=color:#66d9ef>in</span> fields)
            {
                SerializedProperty fieldProp = valueProp.FindPropertyRelative(field.Name);

                <span style=color:#66d9ef>if</span> (fieldProp != <span style=color:#66d9ef>null</span>)
                    EditorGUILayout.PropertyField(fieldProp, <span style=color:#66d9ef>new</span> GUIContent(ObjectNames.NicifyVariableName(field.Name)));
            }
        }
        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (valueProp != <span style=color:#66d9ef>null</span> &amp;&amp; valueProp.propertyType == SerializedPropertyType.ObjectReference)
            EditorGUILayout.HelpBox(<span style=color:#e6db74>&#34;You cannot wrap values that derive from UnityEngine.Object.&#34;</span>, MessageType.Warning);
        <span style=color:#66d9ef>else</span>
            EditorGUILayout.HelpBox(<span style=color:#e6db74>&#34;No valid &#39;Value&#39; property found.&#34;</span>, MessageType.Warning);

        serializedObject.ApplyModifiedProperties();
    }

    <span style=color:#75715e>// this is instead of setting the icon manualy for each new derived ScriptableHolder
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> Texture2D RenderStaticPreview(<span style=color:#66d9ef>string</span> assetPath, Object[] subAssets, <span style=color:#66d9ef>int</span> width, <span style=color:#66d9ef>int</span> height)
    {
        SerializedProperty valueProp = serializedObject.FindProperty(<span style=color:#e6db74>&#34;Value&#34;</span>);

        <span style=color:#66d9ef>if</span> (valueProp != <span style=color:#66d9ef>null</span> &amp;&amp; valueProp.propertyType == SerializedPropertyType.Generic)
        {
            <span style=color:#66d9ef>var</span> icon = AssetDatabase.LoadAssetAtPath&lt;Texture2D&gt;(<span style=color:#e6db74>&#34;Assets/Gizmos/ScriptableHolder Icon.png&#34;</span>);

            EditorGUIUtility.SetIconForObject(target, icon);
        }
        <span style=color:#66d9ef>else</span>
        {
            EditorGUIUtility.SetIconForObject(target, EditorGUIUtility.IconContent(<span style=color:#e6db74>&#34;console.warnicon@2x&#34;</span>).image <span style=color:#66d9ef>as</span> Texture2D);
        }

        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>base</span>.RenderStaticPreview(assetPath, subAssets, width, height);
    }
}
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#a6e22e>[UnityEngine.CreateAssetMenu(menuName = &#34;Create Player Mock API Holder&#34;)]</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PlayerMockAPIResponseHolder</span> : ScriptableHolder&lt;PlayerMockAPIResponse&gt; { }
</code></pre></div><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>If you are worried about encapsulation of the Value field, you can use a virtual property to allow inheritors to define their own access modifier to the value. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>You don&rsquo;t have to place the image in the Gizmos folder or name it so, but&mldr; Images places in the Gizmos and named in the following pattern &ldquo;&lt;SCRIPTNAME> Icon&rdquo; will replace the icon for the script. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.dorbendor.com%2fposts%2farticles%2funity%2fscriptableholders%2f" target=_blank><i class="fab fa-facebook"></i></a><a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fwww.dorbendor.com%2fposts%2farticles%2funity%2fscriptableholders%2f&text=Scriptable%20Holders&via=Dor%20Ben%20Dor" target=_blank><i class="fab fa-twitter"></i></a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fwww.dorbendor.com%2fposts%2farticles%2funity%2fscriptableholders%2f&title=Scriptable%20Holders" target=_blank><i class="fab fa-reddit"></i></a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.dorbendor.com%2fposts%2farticles%2funity%2fscriptableholders%2f&title=Scriptable%20Holders" target=_blank><i class="fab fa-linkedin"></i></a><a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=Scriptable%20Holders https%3a%2f%2fwww.dorbendor.com%2fposts%2farticles%2funity%2fscriptableholders%2f" target=_blank><i class="fab fa-whatsapp"></i></a><a class="btn btn-sm email-btn" href="mailto:?subject=Scriptable%20Holders&body=https%3a%2f%2fwww.dorbendor.com%2fposts%2farticles%2funity%2fscriptableholders%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/MisterKidX/MisterKidX.github.io/edit/source/content/posts/articles/Unity/scriptableHolders/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/projects/published/warriors-rise-to-glory/ title="Warriors Rise To Glory" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Warriors Rise To Glory</div></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;var disqus_shortname="dorbendor-com";dsq.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#preface>Preface</a></li><li><a href=#abstract>Abstract</a><ul><li><a href=#code-solution>Code Solution</a></li></ul></li><li><a href=#editor>Editor</a><ul><li><a href=#the-annoying-foldout-arrow>The Annoying Foldout Arrow</a></li><li><a href=#denying-bad-generic-arguments>Denying Bad Generic Arguments</a></li><li><a href=#improving-editor-ux>Improving Editor UX</a></li></ul></li><li><a href=#summary>Summary</a><ul><li><ul><li><a href=#important-links>Important Links</a></li></ul></li><li><a href=#final-code>Final Code</a></li></ul></li></ul></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.dorbendor.com#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://www.dorbendor.com#skills>Toolbox</a></li><li class=nav-item><a class=smooth-scroll href=https://www.dorbendor.com#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=/tags>Tags</a></li><li class=nav-item><a class=smooth-scroll href=/categories>Categories</a></li><li class=nav-item><a class=smooth-scroll href=https://ko-fi.com/dorbendor>Buy Me Coffee</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:contact@dorbendor.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span><span>contact@dorbendor.com</span></a></li><li><a href=https://github.com/misterkidx target=_blank rel=noopener><span><i class="fab fa-github"></i></span><span>misterkidx</span></a></li><li><a href=https://www.linkedin.com/in/dorbendor target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span><span>Dor Ben Dor</span></a></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form action=http://eepurl.com/g-jbd9 method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div class=form-group><input type=email class=form-control id=mce-EMAIL name=EMAIL aria-describedby=emailHelp placeholder="Enter email">
<small id=emailHelp class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small></div><button type=submit class="btn btn-info">Submit</button></form></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script type=text/javascript src=/js/darkreader.js></script><script type=text/javascript src=/js/darkmode-darkreader.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>